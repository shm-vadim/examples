{% extends 'main.html.twig' %}

{% block title %}{{profile.title}}{% endblock %}

{%macro el(t, i)%}
<li>{{t|raw}}: {{i|raw}}</li>
{%endmacro%}


{%macro row(t, i)%}
{%from _self import el as el%}
{{el(form_label(i, t), form_widget(i))}}
{%endmacro%}

{%macro list(f, inps)%}
{%from _self import row as row%}
<ul>
{%for t, k in inps%}
{%set i=f[k]%}
{{row(t, i)}}
{%endfor%}
</ul>
{%endmacro%}

{% block main%}
   <h1>{{h1Title ?? "Редактировать профиль"}}</h1>
{{ form_start(form) }}
{{form_errors(form)}}
{%from _self import row as row%}
{%from _self import el as el%}
{%from _self import list as list%}

<h2>Параметры попытки</h2>
<ul>
{{row("Описание профиля", form.description)}}
{{row("Количество примеров в попытке", form.examplesCount)}}
{{el("Длительность попытки (мин:сек):", form_widget(form.minutes)~":"~form_widget(form.seconds))}}
<li>{{(form_label(form.isDemanding, "Повторять пример до получения правильного ответа")~form_widget(form.isDemanding))|raw}}</li>
</ul>

<h2>Параметры примеров на сложение</h2>
{{list(form, {"Минимальное слагаемое": "addMin", "Максимальное слагаемое": "addMax", "Процент примеров на сложение": "addPerc"})}}

<h2>Параметры примеров на вычитание</h2>
{{list(form, {"Минимальное уменьшаемое": "subMin", "Максимальное уменьшаемое": "subMax", "Минимальная разность": "minSub", "Процент примеров на вычитание": "subPerc"})}}

<h2>Параметры примеров на умножение</h2>
{{list(form, {"Минимальный множитель": "multMin", "Максимальный множитель": "multMax", "Процент примеров на умножение": "multPerc"})}}

<h2>Параметры примеров на деление</h2>
{{list(form, {"Минимальное делимое": "divMin", "Максимальное делимое": "divMax", "Минимальная частное": "minDiv", "Процент примеров на деление": "divPerc"})}}

{%if is_granted("ROLE_ADMIN")%}
<h2>Параметры для администратора</h2>
<ul>
<li>{{form_label(form.isPublic, "Общий профиль")}}{{form_widget(form.isPublic)}}</li>
<li>{{form_label(form.author, "Создатель профиля")}}{{form_widget(form.author)}}</li>
<li>{{form_label(form.addTime, "Время создания профиля")}}{{form_widget(form.addTime)}}</li>
<ul>
{%endif%}

{%if is_granted(canEdit ?? "EDIT", profile)%}
    <button class="btn">Сохранить</button>
{%endif%}
{{ form_end(form) }}

<a href="{{path("profile_index")}}">Вернуться к списку профилей</a>
{%if is_granted("DELETE", profile)%}
{{include("profile/_delete_form.html.twig")}}
{%endif%}
{% endblock %}

{%block javascripts%}
{{parent()}}
<script>
if (!P.canEdit) $("input, button, select").attr("disabled", true);
</script>
{%endblock%}