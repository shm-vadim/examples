{% macro index_table(title, students, userRepository) %}
    <h1>{{title}}</h1>

    <table>
        <thead>
            <tr>
                <th>№</th>
                <th>Фамилия / Имя</th>
                <th>Логин</th>
                <th>Время последней попытки</th>
                <th>Дн. Завершенных попыток (Попыток/Дн)</th>
                <th>Дн. Решенных примеров (Примеров/Дн)</th>
                <th>Действия</th>
            </tr>
        </thead>
        <tbody>
            {% for number, student in sortStudents(students) %}
                {%set student = student.setEntityRepository(userRepository)%}
                <tr>
                    <td>{{number+1}}</td>
                    <td>
                        {{student.lastName}}
                        {{student.firstName}}
                    </td>
                    <td>{{student.username}}</td>
                    {%set attempt = student.attempts.last%}
                    <td>{{attempt ? attempt.addTime : "-"}}</td>
                    <td>
                        {% set days = [1, 3, 7, 30] %}
                        {% for day in days %}
                            <div>
                                {{ day }}.
                                {% set doneAttemptsCount = userRepository.getDoneAttemptsCount(student, dt('createBySubDays', day)) %}
                                {{ doneAttemptsCount }}
                                ({{ (doneAttemptsCount / day)|round(2) }})
                            </div>
                        {% endfor %}
                    </td>
                    <td>
                        {% for day in days %}
                            <div>
                                {{ day }}.
                                {% set solvedExamplesCount  = userRepository.GetSolvedExamplesCount(student, dt('createBySubDays', day)) %}
                                {{ solvedExamplesCount }}
                                ({{ (solvedExamplesCount / day)|round(2) }})
                            </div>
                        {% endfor %}
                    </td>
                    <td>

                        {% if is_granted('EDIT_CHILD', student) %}{% endif %}

                        {% if is_granted("LOGIN_AS_CHILD", student) %}{% endif %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% endmacro %}